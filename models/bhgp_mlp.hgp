// recursive multilayer perceptron

verify_signature ( y => a );

cell mlp( y => hidden_nodes, reduction_factor, a )
{
    w = adapt : /*rand :*/ ( [ hidden_nodes ][ dimof( a ) ]# );
    b = adapt : ( [ hidden_nodes ]0 );
    q = b + w ** a;
    y = if( floor( hidden_nodes ) == 1 )
        then tanh( q )
        else mlp( hidden_nodes * reduction_factor, reduction_factor, relu_leaky( q ) );
};

y =	mlp( 10, 0.5, a );
