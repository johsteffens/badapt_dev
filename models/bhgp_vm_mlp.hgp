// recursive multilayer perceptron

verify_signature ( y => dim_y, a );

y =	cell mlp( y => dim_y, hidden_nodes, reduction_factor, a )
{
    w = adapt : /*rand :*/ ( [ hidden_nodes ][ dimof( a ) ]# );
    b = adapt : ( [ hidden_nodes ]0 );
    q = b + w ** a;
    y = if( floor( hidden_nodes ) <= dim_y )
        then tanh( q )
        else mlp( dim_y, hidden_nodes * reduction_factor, reduction_factor, relu_leaky( q ) );
} ( dim_y, 10, 0.8, a );

